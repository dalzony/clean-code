# 13. 동시성

## 동시성 이란?
- 결합을 없애고 '무엇'과 '언제'를 분리하는 전략
- 멀티스레딩 개발

## 동시성이 필요한 이유
- 프로레싱성능 한계로 인해 동시성 구현이 불가피
- 분리가 쉬워지는 구조적 장점

## 동시성의 잘못된 생각
- 동시성은 항상 성능을 높여준다? (X)
<br> --> 공유하는 자료가 많고 대기시간이 증가하게 되면 성능이 더 낮아질 수 있다.</br>

- 동시성을 구현해도 설계는 변하지 않는다? (X)
<br> --> 설계가 달라져야 하고 시스템 구조가 달라진다.</br>

- 웹이나 EJB 컨테이너를 사용하면 동시성을 이해할 필요가 없다? (X)
<br> --> 컨테이너 동작 원리를 이해해야 동시 수정, 데드락 같은 문제를 피할 수 있다.</br>

## 동시성의 타당한 생각
- 성능 부하를 유발한다.
- 복장하다.
- 재현하기 어렵다. (일회성 문제로 간주된다. 타이밍 이슈)
- 전략적인 설계가 필요하다.

## 동시성 문제 발생의 예
```java
public class X {
  private int lastIdUsed;
  public int getNextId(){
    return ++lastIdUsed;
  }
}
```

## 동시성 방어 원칙
- 단일 책임 원칙 (Single Responsiblity Principle)
<br>자료 범위를 제한하라
<br>자료 사본을 사용하라
<br>스레드는 가능한 독립적으로 구현하라

- 라이브러리를 이해하라
<br>스레드환경에 안전한 집합 컬렉션

- 실행 모델을 이해하라
<br>생산자-소비자
<br>읽기-쓰기
<br>식사하는 철학자들

- 동기화하는 메소드 사이에 의존성을 이해하라

- 동기화하는 부분을 작게 만들어라

- 올바른 종료 코드를 구현하라

## 스레드 코드 테스트
